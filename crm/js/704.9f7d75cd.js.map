{"version":3,"file":"js/704.9f7d75cd.js","mappings":"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","sources":["webpack://crm-system/./src/views/Record.vue","webpack://crm-system/./src/views/Record.vue?707c"],"sourcesContent":["<template>\r\n  <div>\r\n    <div class=\"page-title\">\r\n      <h3>Новая запись</h3>\r\n    </div>\r\n    <loader v-if=\"isLoading\"/>\r\n    <p v-else-if=\"!$store.getters.categories.length\" class=\"center\">\r\n      Категорий пока нет.\r\n      <router-link to=\"/categories\">Добавьте новую категорию</router-link>\r\n    </p>\r\n\r\n    <form v-else class=\"form\" @submit.prevent=\"sendRecord\">\r\n      <div class=\"input-field\">\r\n        <select ref=\"select\" v-model=\"activeOption\">\r\n          <option\r\n            v-for=\"category in $store.getters.categories\"\r\n            :value=\"category.id\"\r\n            :key=\"category.id\">\r\n            {{ category.title }}\r\n          </option>\r\n        </select>\r\n        <label>Выберите категорию</label>\r\n      </div>\r\n\r\n      <div class=\"mb-2\">\r\n        <label class=\"radio-label\">\r\n          <input\r\n            class=\"with-gap\"\r\n            name=\"type\"\r\n            type=\"radio\"\r\n            value=\"income\"\r\n            v-model=\"typeMoney\"\r\n          />\r\n          <span>Доход</span>\r\n        </label>\r\n\r\n        <label class=\"radio-label\">\r\n          <input\r\n            class=\"with-gap\"\r\n            name=\"type\"\r\n            type=\"radio\"\r\n            value=\"outcome\"\r\n            v-model=\"typeMoney\"\r\n          />\r\n          <span>Расход</span>\r\n        </label>\r\n      </div>\r\n\r\n      <div class=\"input-field\">\r\n        <input\r\n          id=\"amount\"\r\n          type=\"number\"\r\n          v-model.number=\"amount\"\r\n          :class=\"{invalid: v$.amount.$errors.length}\"\r\n        >\r\n        <label for=\"amount\">Сумма</label>\r\n        <small v-if=\"isLimit\" class=\"helper-text invalid\">Минимальная величина {{ maxLimit }}</small>\r\n      </div>\r\n\r\n      <div class=\"input-field\">\r\n        <input\r\n          id=\"description\"\r\n          type=\"text\"\r\n          v-model.trim=\"description\"\r\n          :class=\"{invalid: v$.description.$errors.length}\"\r\n        >\r\n        <label for=\"description\">Описание</label>\r\n        <small\r\n          v-if=\"v$.description.$errors\"\r\n          class=\"helper-text invalid\"\r\n          v-for=\"error of v$.description.$errors\">\r\n          {{ addError(error.$validator, error.$params.min) }}\r\n        </small>\r\n      </div>\r\n\r\n      <button class=\"btn waves-effect waves-light\" type=\"submit\">\r\n        Создать\r\n        <i class=\"material-icons right\">send</i>\r\n      </button>\r\n    </form>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport useVuelidate from \"@vuelidate/core\";\r\nimport Loader from \"@/components/Loader\";\r\nimport {minLength, minValue, required} from \"@vuelidate/validators\";\r\nimport {mapGetters} from 'vuex';\r\n\r\nexport default {\r\n  components: {Loader},\r\n  data: () => ({\r\n    v$: useVuelidate(),\r\n    isLoading: true,\r\n    select: null,\r\n    activeOption: null,\r\n    typeMoney: 'income',\r\n    amount: 0,\r\n    description: '',\r\n  }),\r\n  validations() {\r\n    return {\r\n      amount: {required, minValue: minValue(10)},\r\n      description: {required, minLength: minLength(2)},\r\n    }\r\n  },\r\n  methods: {\r\n    formatDate(date) {\r\n      const pathOne = date.split('T')[0].split('-').reverse().join('.');\r\n      const pathTwo = date.split('T')[1].split('.')[0];\r\n      return pathTwo + \" \" + pathOne;\r\n    },\r\n    async sendRecord() {\r\n      if (this.v$.$invalid) {\r\n        return this.v$.$touch();\r\n      }\r\n      if (this.isCanCreateAmount) {\r\n        try {\r\n          await this.$store.dispatch('sendAmount', {\r\n            id: this.activeOption,\r\n            typeMoney: this.typeMoney,\r\n            amount: this.amount,\r\n            description: this.description,\r\n            date: new Date().toJSON()\r\n          });\r\n\r\n          const money = this.typeMoney === 'income' ?\r\n            this.info.money + this.amount :\r\n            this.info.money - this.amount;\r\n\r\n          await this.$store.dispatch('updateInfo', money)\r\n\r\n          this.$alert('Запись создана!');\r\n          this.activeOption = this.$store.getters.categories[0].id;\r\n          this.description = '';\r\n          this.amount = 0;\r\n          this.v$.$reset();\r\n        } catch (e) {\r\n        }\r\n      } else {\r\n        this.$alert(`Не хватает ${this.amount - this.info.money}`)\r\n      }\r\n    },\r\n    addError(name, count = 0) {\r\n      if (name === 'required') {\r\n        return 'Поле не должно быть пустым';\r\n      } else if (name === 'minLength') {\r\n        return `Минимальная длина должна быть ${count} символа`;\r\n      }\r\n    }\r\n  },\r\n  computed: {\r\n    ...mapGetters(['info']),\r\n    isLimit() {\r\n      return this.v$.amount.$errors.length && this.amount < this.v$.amount.minValue.$params.min;\r\n    },\r\n    maxLimit() {\r\n      return this.v$.amount.minValue.$params.min;\r\n    },\r\n    isCanCreateAmount() {\r\n      if (this.typeMoney === 'income') {\r\n        return true;\r\n      } else {\r\n        return this.info.money >= this.amount;\r\n      }\r\n    }\r\n  },\r\n  async mounted() {\r\n    await this.$store.dispatch('getCategories')\r\n    this.isLoading = false;\r\n\r\n    setTimeout(() => {\r\n      this.select = M.FormSelect.init(this.$refs.select);\r\n      M.updateTextFields();\r\n    }, 0);\r\n\r\n    if (this.$store.getters.categories.length) {\r\n      this.activeOption = this.$store.getters.categories[0].id;\r\n    }\r\n\r\n\r\n  },\r\n  destroyed() {\r\n    if (this.select && this.select.destroy) {\r\n      this.select.destroy()\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.radio-label {\r\n  display: block;\r\n  margin-bottom: 1rem;\r\n  text-align: left;\r\n}\r\n\r\n.mb-2 {\r\n  margin-bottom: 2rem;\r\n}\r\n</style>\r\n","import { render } from \"./Record.vue?vue&type=template&id=1ab75e4e&scoped=true\"\nimport script from \"./Record.vue?vue&type=script&lang=js\"\nexport * from \"./Record.vue?vue&type=script&lang=js\"\n\nimport \"./Record.vue?vue&type=style&index=0&id=1ab75e4e&scoped=true&lang=css\"\n\nimport exportComponent from \"C:\\\\Users\\\\cmg-user\\\\Desktop\\\\все\\\\Школа Минина\\\\vue\\\\13- курсовые\\\\99-crm-system\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-1ab75e4e\"]])\n\nexport default __exports__"],"names":["_createElementVNode","class","for","type","_createElementBlock","_hoisted_1","_ctx","_createBlock","_component_loader","key","getters","categories","length","onSubmit","$options","ref","$event","_Fragment","_renderList","category","value","id","title","_hoisted_6","_hoisted_7","name","_hoisted_10","_hoisted_12","invalid","amount","$errors","_hoisted_14","_toDisplayString","description","_hoisted_17","error","$validator","$params","min","_hoisted_19","_createVNode","_component_router_link","to","components","Loader","data","v$","useVuelidate","isLoading","select","activeOption","typeMoney","validations","required","minValue","minLength","methods","formatDate","date","pathOne","split","reverse","join","pathTwo","async","this","$invalid","$touch","isCanCreateAmount","$store","dispatch","Date","toJSON","money","info","$alert","$reset","e","addError","count","computed","mapGetters","isLimit","maxLimit","setTimeout","M","FormSelect","init","$refs","updateTextFields","destroyed","destroy","__exports__","render"],"sourceRoot":""}